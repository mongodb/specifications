description: serverMonitoringMode

schemaVersion: "1.3"

tests:
  - description: "connect with serverMonitoringMode=auto"
    operations:
      - name: createEntities
        object: testRunner
        arguments:
          entities:
            - client:
                id: &client0 client0
                uriOptions:
                  serverMonitoringMode: "auto"
            - database:
                id: &dbServerMonitoringModeAuto dbServerMonitoringModeAuto
                client: *client0
                databaseName: sdam-tests
      - name: runCommand
        object: *dbServerMonitoringModeAuto
        arguments:
          commandName: ping
          command: { ping: 1 }
        expectResult: { ok: 1 }

  - description: "connect with serverMonitoringMode=stream"
    operations:
      - name: createEntities
        object: testRunner
        arguments:
          entities:
            - client:
                id: &client1 client1
                uriOptions:
                  serverMonitoringMode: "stream"
            - database:
                id: &dbServerMonitoringModeStream dbServerMonitoringModeStream
                client: *client1
                databaseName: sdam-tests
      - name: runCommand
        object: *dbServerMonitoringModeStream
        arguments:
          commandName: ping
          command: { ping: 1 }
        expectResult: { ok: 1 }

  - description: "connect with serverMonitoringMode=poll"
    operations:
      - name: createEntities
        object: testRunner
        arguments:
          entities:
            - client:
                id: &client2 client2
                uriOptions:
                  serverMonitoringMode: "poll"
            - database:
                id: &dbServerMonitoringModePoll dbServerMonitoringModePoll
                client: *client2
                databaseName: sdam-tests
      - name: runCommand
        object: *dbServerMonitoringModePoll
        arguments:
          commandName: ping
          command: { ping: 1 }
        expectResult: { ok: 1 }
