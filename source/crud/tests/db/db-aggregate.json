{
  "data": [],
  "tests": [
    {
      "description": "Aggregate with $currentOp",
      "operation": {
        "name": "db-aggregate",
        "database_name": "admin",
        "arguments": {
          "pipeline": [
            {
              "$currentOp": {
                "allUsers": true,
                "idleConnections": true
              }
            },
            {
              "$match": {
                "command.aggregate": {
                  "$eq": 1
                }
              }
            },
            {
              "$project": {
                "command": 1
              }
            },
            {
              "$project": {
                "command.lsid": false
              }
            }
          ]
        }
      },
      "outcome": {
        "result": [
          {
            "command": {
              "aggregate": 1,
              "pipeline": [
                {
                  "$currentOp": {
                    "allUsers": true,
                    "idleConnections": true
                  }
                },
                {
                  "$match": {
                    "command.aggregate": {
                      "$eq": 1
                    }
                  }
                },
                {
                  "$project": {
                    "command": 1
                  }
                },
                {
                  "$project": {
                    "command.lsid": false
                  }
                }
              ],
              "cursor": {},
              "$db": "admin"
            }
          }
        ]
      }
    },
    {
      "description": "Aggregate with $currentOp and allowDiskUse",
      "operation": {
        "name": "db-aggregate",
        "database_name": "admin",
        "arguments": {
          "pipeline": [
            {
              "$currentOp": {
                "allUsers": true,
                "idleConnections": true
              }
            },
            {
              "$match": {
                "command.aggregate": {
                  "$eq": 1
                }
              }
            },
            {
              "$project": {
                "command": 1
              }
            },
            {
              "$project": {
                "command.lsid": false
              }
            }
          ],
          "allowDiskUse": true
        }
      },
      "outcome": {
        "result": [
          {
            "command": {
              "aggregate": 1,
              "pipeline": [
                {
                  "$currentOp": {
                    "allUsers": true,
                    "idleConnections": true
                  }
                },
                {
                  "$match": {
                    "command.aggregate": {
                      "$eq": 1
                    }
                  }
                },
                {
                  "$project": {
                    "command": 1
                  }
                },
                {
                  "$project": {
                    "command.lsid": false
                  }
                }
              ],
              "allowDiskUse": true,
              "cursor": {},
              "$db": "admin"
            }
          }
        ]
      }
    }
  ]
}
